<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WAYNAçš„æ‰‹æ©ŸéŠæˆ²å¤©å ‚ - NEON MOBILE V9.5</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-pink: #bc13fe;
            --neon-green: #0aff68;
            --neon-red: #ff0055;
            --neon-yellow: #ffdd00;
            --bg-dark: #050511;
            --bg-panel: rgba(20, 20, 35, 0.95);
            --text-main: #e0e6ed;
        }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        
        body {
            font-family: 'Orbitron', 'Noto Sans TC', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
            background-image: 
                linear-gradient(rgba(0, 243, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* Sidebar & Menu */
        #sidebar {
            width: 280px; background: var(--bg-panel); backdrop-filter: blur(10px);
            border-right: 1px solid rgba(0, 243, 255, 0.3); padding: 20px;
            display: flex; flex-direction: column; overflow-y: auto; z-index: 20;
            box-shadow: 5px 0 25px rgba(0,0,0,0.8);
            transition: transform 0.3s ease;
        }
        #menu-toggle {
            display: none; position: fixed; top: 10px; left: 10px; z-index: 100;
            background: var(--bg-panel); border: 1px solid var(--neon-blue); color: var(--neon-blue);
            padding: 8px 12px; border-radius: 5px; cursor: pointer; font-family: 'Orbitron';
        }
        h1 { 
            font-size: 24px; color: var(--neon-blue); text-align: center; margin-bottom: 20px;
            text-shadow: 0 0 10px var(--neon-blue); border-bottom: 2px solid var(--neon-pink); padding-bottom: 15px;
            letter-spacing: 2px;
        }
        .nav-header { 
            font-size: 12px; color: var(--neon-pink); margin-top: 15px; margin-bottom: 8px; 
            text-transform: uppercase; border-bottom: 1px solid rgba(188, 19, 254, 0.3); padding-bottom: 2px;
            letter-spacing: 1px; font-weight: bold;
        }
        .nav-btn {
            background: linear-gradient(90deg, rgba(255,255,255,0.05) 0%, transparent 100%);
            border: none; border-left: 3px solid transparent; color: #aaa; padding: 12px 15px; margin-bottom: 4px;
            cursor: pointer; text-align: left; transition: 0.3s; font-size: 14px; width: 100%; font-family: 'Noto Sans TC', sans-serif;
        }
        .nav-btn.active { 
            background: linear-gradient(90deg, rgba(188, 19, 254, 0.2) 0%, transparent 100%);
            color: #fff; border-left-color: var(--neon-pink); text-shadow: 0 0 8px var(--neon-pink); font-weight: bold;
        }

        /* Game Area */
        #game-area {
            flex: 1; padding: 10px; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; 
            position: relative; overflow-y: auto; padding-bottom: 180px; 
        }
        .game-section {
            display: none; background: rgba(16, 20, 30, 0.85); backdrop-filter: blur(5px);
            padding: 20px; border-radius: 15px; box-shadow: 0 0 30px rgba(0, 243, 255, 0.15); 
            text-align: center; width: 100%; max-width: 600px; border: 1px solid rgba(0, 243, 255, 0.3); 
            margin-top: 40px; 
        }
        .game-section.active { display: block; animation: zoomIn 0.3s ease-out; }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        h2 { color: var(--neon-blue); text-shadow: 0 0 10px var(--neon-blue); margin-top: 0; font-size: 24px;}
        button.action-btn {
            background: transparent; color: var(--neon-blue); border: 2px solid var(--neon-blue); padding: 8px 20px;
            font-size: 16px; cursor: pointer; border-radius: 5px; margin: 10px; font-weight: bold; transition: 0.2s; outline: none;
            font-family: 'Orbitron', sans-serif; box-shadow: 0 0 5px var(--neon-blue) inset;
        }
        button.action-btn:active { background: var(--neon-blue); color: #000; }
        
        .score-board { font-size: 18px; margin: 10px 0; font-weight: bold; color: #fff; text-shadow: 0 0 5px rgba(255,255,255,0.5); }
        canvas { background: #000; border: 2px solid #333; margin: 0 auto; display: block; max-width: 100%; box-shadow: 0 0 15px rgba(0,0,0,0.8); border-radius: 4px; touch-action: none; }

        /* Mobile Controls */
        #mobile-controls {
            position: fixed; bottom: 0; left: 0; width: 100%; height: 160px;
            background: linear-gradient(to top, rgba(0,0,0,0.95), rgba(0,0,0,0));
            z-index: 50; display: flex; justify-content: space-between; align-items: center;
            padding: 10px 20px 30px 20px; pointer-events: none; 
        }
        .d-pad, .action-pad { pointer-events: auto; }
        .d-pad { display: grid; grid-template-columns: 60px 60px 60px; grid-template-rows: 50px 50px; gap: 5px; justify-items: center; align-items: center; }
        .d-btn {
            width: 55px; height: 50px; background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--neon-blue); border-radius: 8px;
            color: var(--neon-blue); font-size: 24px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; box-shadow: 0 0 10px rgba(0, 243, 255, 0.2); transition: 0.1s;
        }
        .d-btn:active, .d-btn.active-touch { background: var(--neon-blue); color: #000; box-shadow: 0 0 20px var(--neon-blue); transform: scale(0.95); }
        .d-up { grid-column: 2; grid-row: 1; }
        .d-left { grid-column: 1; grid-row: 2; }
        .d-down { grid-column: 2; grid-row: 2; }
        .d-right { grid-column: 3; grid-row: 2; }
        .action-pad { display: flex; align-items: center; justify-content: center; padding-right: 10px; }
        .a-btn {
            width: 70px; height: 70px; border-radius: 50%; background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--neon-pink); color: var(--neon-pink); font-size: 18px; font-weight: bold;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
            box-shadow: 0 0 15px rgba(188, 19, 254, 0.3); transition: 0.1s;
        }
        .a-btn:active, .a-btn.active-touch { background: var(--neon-pink); color: #fff; box-shadow: 0 0 30px var(--neon-pink); transform: scale(0.95); }

        @media (max-width: 800px) {
            body { flex-direction: column; }
            #sidebar { 
                position: fixed; top: 0; left: 0; width: 260px; height: 100vh; 
                transform: translateX(-100%); transition: transform 0.3s ease;
                box-shadow: 2px 0 10px rgba(0,0,0,0.8);
            }
            #sidebar.open { transform: translateX(0); }
            #menu-toggle { display: block; }
            #game-area { width: 100%; height: 100vh; padding: 10px; padding-bottom: 180px;}
            .game-section { width: 100%; padding: 15px; margin-top: 50px; max-height: 70vh; overflow-y: auto;}
        }
    </style>
</head>
<body>

    <button id="menu-toggle" onclick="toggleMenu()">â˜° é¸å–®</button>

    <div id="sidebar">
        <h1>WAYNA<br>GAME PARADISE</h1>
        <button class="nav-btn active" onclick="switchGame('welcome')">ğŸ  å¤§å»³é¦–é </button>

        <div class="nav-header">ğŸ”¥ V9.5 æ–°éŠæˆ²</div>
        <button class="nav-btn" onclick="switchGame('game26')">ğŸš€ æ˜Ÿéš›å°„æ“Š (å‡ç´š)</button>
        <button class="nav-btn" onclick="switchGame('game27')">ğŸ—ï¸ å †é«˜é«˜</button>
        <button class="nav-btn" onclick="switchGame('game28')">ğŸï¸ éœ“è™¹è³½è»Š (æ–°!)</button>
        <button class="nav-btn" onclick="switchGame('game30')">ğŸŒŒ æ˜Ÿéš›è·³èº (æ–°!)</button>
        <button class="nav-btn" onclick="switchGame('game29')">ğŸ—ºï¸ è¿·å®®é€ƒè„«</button>

        <div class="nav-header">ç¶“å…¸ç²¾é¸</div>
        <button class="nav-btn" onclick="switchGame('game6')">ğŸ è²ªé£Ÿè›‡</button>
        <button class="nav-btn" onclick="switchGame('game16')">ğŸ§± ä¿„ç¾…æ–¯æ–¹å¡Š</button>
        <button class="nav-btn" onclick="switchGame('game19')">ğŸ”¢ 2048</button>
        <button class="nav-btn" onclick="switchGame('game17')">ğŸ¦ é£›ç¿”å°é³¥</button>
    </div>

    <div id="game-area">
        <div id="welcome" class="game-section active">
            <h2 style="font-size: 32px; margin-bottom: 10px;">NEON MOBILE<br>V9.5</h2>
            <div style="margin: 20px; padding: 15px; border: 1px solid var(--neon-pink); border-radius: 10px; background: rgba(188, 19, 254, 0.1);">
                <p style="color: var(--neon-pink); font-weight: bold;">ğŸ”§ ç‰ˆæœ¬æ›´æ–°</p>
                <ul style="text-align: left; color: #ccc; font-size: 14px; padding-left: 20px;">
                    <li><b>ğŸï¸ éœ“è™¹è³½è»Š</b>: å…¨æ–°è³½è»Šé–ƒé¿éŠæˆ²ï¼Œé€Ÿåº¦æœƒè¶Šä¾†è¶Šå¿«ï¼</li>
                    <li><b>ğŸŒŒ æ˜Ÿéš›è·³èº</b>: å·¦å³ç§»å‹•è¸©å¹³å°ï¼ŒæŒ‘æˆ°æœ€é«˜é«˜åº¦ï¼</li>
                    <li><b>ğŸš€ æ˜Ÿéš›å°„æ“Š</b>: æ”¯æ´ A éµ/ç©ºç™½éµå°„æ“Šã€‚</li>
                    <li><b>ğŸ—ï¸ å †é«˜é«˜</b>: é€Ÿåº¦èˆ‡æ‰‹æ„Ÿå„ªåŒ–ã€‚</li>
                </ul>
            </div>
        </div>

        <div id="game26" class="game-section">
            <h2>æ˜Ÿéš›å°„æ“Š DX</h2>
            <div class="score-board">SCORE: <span id="space-score">0</span> | LV: <span id="space-level">1</span></div>
            <canvas id="space-canvas" width="300" height="400"></canvas>
            <p style="font-size:12px;color:#888;">â¬…ï¸â¡ï¸ç§»å‹• / <b>A</b> å°„æ“Š</p>
            <button class="action-btn" onclick="startSpace()">MISSION START</button>
        </div>

        <div id="game27" class="game-section">
            <h2>å †é«˜é«˜</h2>
            <div class="score-board">LEVEL: <span id="stack-score">0</span></div>
            <p style="font-size:14px; color:var(--neon-green)">æŒ‰ä¸‹ A è®“æ–¹å¡Šåœä¸‹</p>
            <canvas id="stack-canvas" width="240" height="360"></canvas>
            <button class="action-btn" onclick="startStack()">START GAME</button>
        </div>

        <div id="game28" class="game-section">
            <h2>éœ“è™¹è³½è»Š</h2>
            <div class="score-board">SCORE: <span id="racer-score">0</span></div>
            <canvas id="racer-canvas" width="240" height="350"></canvas>
            <p style="font-size:12px;color:#888;">â¬…ï¸â¡ï¸å·¦å³ç§»å‹•é–ƒé¿éšœç¤™ç‰©</p>
            <button class="action-btn" onclick="startRacer()">START ENGINE</button>
        </div>

        <div id="game30" class="game-section">
            <h2>æ˜Ÿéš›è·³èº</h2>
            <div class="score-board">HEIGHT: <span id="jump-score">0</span></div>
            <canvas id="jump-canvas" width="300" height="400"></canvas>
            <p style="font-size:12px;color:#888;">â¬…ï¸â¡ï¸æ§åˆ¶æ–¹å‘ï¼Œä¸è¦æ‰ä¸‹å»</p>
            <button class="action-btn" onclick="startJump()">JUMP!</button>
        </div>

        <div id="game29" class="game-section">
            <h2>è¿·å®®é€ƒè„«</h2>
            <div class="score-board">TIME: <span id="maze-time">0</span>s</div>
            <canvas id="maze-canvas" width="300" height="300"></canvas>
            <p style="font-size:12px;color:#888;">æ–¹å‘éµç§»å‹•ç¶ é»ï¼Œå‰å¾€ç´…é»</p>
            <button class="action-btn" onclick="startMaze()">NEW MAZE</button>
        </div>

        <div id="game6" class="game-section"><h2>è²ªé£Ÿè›‡</h2><div class="score-board">SCORE: <span id="snake-score">0</span></div><canvas id="snake-canvas" width="300" height="300"></canvas><button class="action-btn" onclick="startSnake()">PLAY</button></div>
        <div id="game16" class="game-section"><h2>ä¿„ç¾…æ–¯æ–¹å¡Š</h2><div class="score-board">SCORE: <span id="tetris-score">0</span></div><canvas id="tetris-canvas" width="240" height="400"></canvas><button class="action-btn" onclick="startTetris()">PLAY</button></div>
        <div id="game19" class="game-section"><h2>2048</h2><div class="score-board">SCORE: <span id="g2048-score">0</span></div><div id="grid-2048" style="display:grid;grid-template-columns:repeat(4,1fr);gap:5px;width:240px;margin:10px auto;background:#222;padding:5px;"></div><button class="action-btn" onclick="init2048()">RESET</button></div>
        <div id="game17" class="game-section"><h2>é£›ç¿”å°é³¥</h2><div class="score-board">SCORE: <span id="bird-score">0</span></div><canvas id="bird-canvas" width="300" height="400"></canvas><button class="action-btn" onclick="startBird()">FLY</button></div>
    </div>

    <div id="mobile-controls">
        <div class="d-pad">
            <div class="d-btn d-up" data-key="ArrowUp">â–²</div>
            <div class="d-btn d-left" data-key="ArrowLeft">â—€</div>
            <div class="d-btn d-down" data-key="ArrowDown">â–¼</div>
            <div class="d-btn d-right" data-key="ArrowRight">â–¶</div>
        </div>
        <div class="action-pad">
            <div class="a-btn" data-key=" " id="btn-action">A</div>
        </div>
    </div>

    <script>
        let activeGame='welcome', intervals=[];
        function toggleMenu() { document.getElementById('sidebar').classList.toggle('open'); }
        function switchGame(id){
            intervals.forEach(clearInterval); intervals=[];
            document.querySelectorAll('.game-section').forEach(e=>e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b=>{
                b.classList.remove('active');
                if(b.getAttribute('onclick').includes(id)) b.classList.add('active');
            });
            activeGame=id;
            document.getElementById('sidebar').classList.remove('open');
            // Init Logic
            if(id==='game6') startSnake();
            if(id==='game16') startTetris();
            if(id==='game19') init2048();
            if(id==='game29') startMaze();
        }

        // --- Input Handling ---
        function handleInput(key, type) {
            const isDown = type === 'down';
            if(isDown) {
                if(activeGame==='game6') snakeKey(key);
                if(activeGame==='game16') tetrisKey(key);
                if(activeGame==='game17') birdKey(key);
                if(activeGame==='game19') handle2048(key);
                if(activeGame==='game26') spaceKey(key); 
                if(activeGame==='game27' && (key===' '||key==='Enter'||key==='a'||key==='A')) stackPlace();
                if(activeGame==='game29') mazeKey(key);
            }
            // Hold State
            if(activeGame==='game26') spaceMove(key, isDown);
            if(activeGame==='game28') racerKey(key, isDown); // Racer
            if(activeGame==='game30') jumpKey(key, isDown); // Jump
        }

        window.addEventListener('keydown', e => handleInput(e.key, 'down'));
        window.addEventListener('keyup', e => handleInput(e.key, 'up'));

        document.querySelectorAll('.d-btn, .a-btn').forEach(btn => {
            const key = btn.getAttribute('data-key');
            btn.addEventListener('touchstart', (e) => { e.preventDefault(); btn.classList.add('active-touch'); handleInput(key, 'down'); });
            btn.addEventListener('touchend', (e) => { e.preventDefault(); btn.classList.remove('active-touch'); handleInput(key, 'up'); });
            btn.addEventListener('mousedown', (e) => { btn.classList.add('active-touch'); handleInput(key, 'down'); });
            btn.addEventListener('mouseup', (e) => { btn.classList.remove('active-touch'); handleInput(key, 'up'); });
        });

        // --- GAME 28: Cyber Racer (New) ---
        const rcCtx = document.getElementById('racer-canvas').getContext('2d');
        let rcX=80, rcObs=[], rcScore=0, rcSpeed=4, rcKeys={l:false,r:false}, rcTick=0;
        function startRacer(){
            rcX=80; rcObs=[]; rcScore=0; rcSpeed=4; rcKeys={l:false,r:false}; rcTick=0;
            document.getElementById('racer-score').innerText=0;
            intervals.forEach(clearInterval); intervals.push(setInterval(updRacer, 20));
        }
        function racerKey(k, d){ if(k=='ArrowLeft'||k=='a') rcKeys.l=d; if(k=='ArrowRight'||k=='d') rcKeys.r=d; }
        function updRacer(){
            rcCtx.fillStyle='#111'; rcCtx.fillRect(0,0,240,350);
            
            // Road markings
            rcCtx.fillStyle='#333';
            rcCtx.fillRect(80, (rcTick*rcSpeed)%40 - 40, 4, 390);
            rcCtx.fillRect(160, (rcTick*rcSpeed)%40 - 40, 4, 390);

            // Move Player
            if(rcKeys.l && rcX>0) rcX-=5; if(rcKeys.r && rcX<210) rcX+=5;

            // Draw Player (Car)
            rcCtx.fillStyle='#00f3ff'; 
            rcCtx.beginPath(); rcCtx.moveTo(rcX+15,300); rcCtx.lineTo(rcX,340); rcCtx.lineTo(rcX+30,340); rcCtx.fill();
            rcCtx.fillRect(rcX+10, 310, 10, 20); // cockpit

            // Obstacles
            rcTick++;
            if(rcTick % Math.floor(60/Math.min(3, rcSpeed/2)) == 0){
                let lane = Math.floor(Math.random()*3); // 0, 1, 2
                // center of lanes: 40, 120, 200 roughly
                let obsX = lane * 80 + 25; 
                rcObs.push({x:obsX, y:-40});
            }

            rcObs.forEach((o,i)=>{
                o.y += rcSpeed;
                rcCtx.fillStyle='#ff0055'; 
                rcCtx.fillRect(o.x, o.y, 30, 30); // Block enemy
                rcCtx.fillStyle='#000'; rcCtx.fillRect(o.x+5, o.y+5, 20, 20); // Hollow effect

                if(o.y > 350){
                    rcObs.splice(i,1); rcScore+=10; 
                    document.getElementById('racer-score').innerText=rcScore;
                    if(rcScore%100==0) rcSpeed+=0.5; // Increase speed
                }

                // Collision (Simple Box)
                if(rcX < o.x+30 && rcX+30 > o.x && 310 < o.y+30 && 340 > o.y){
                    intervals.forEach(clearInterval); alert("Crash! Score: "+rcScore);
                }
            });
        }

        // --- GAME 30: Galaxy Jump (New) ---
        const jmpCtx = document.getElementById('jump-canvas').getContext('2d');
        let jmpP={x:135,y:200,vy:0}, jmpPlats=[], jmpKeys={l:false,r:false}, jmpScore=0, jmpH=0;
        function startJump(){
            jmpP={x:135,y:200,vy:-8}; jmpPlats=[]; jmpKeys={l:false,r:false}; jmpScore=0; jmpH=0;
            // Init platforms
            for(let i=0; i<6; i++) jmpPlats.push({x:Math.random()*240, y:i*70});
            document.getElementById('jump-score').innerText=0;
            intervals.forEach(clearInterval); intervals.push(setInterval(updJump, 20));
        }
        function jumpKey(k, d){ if(k=='ArrowLeft'||k=='a') jmpKeys.l=d; if(k=='ArrowRight'||k=='d') jmpKeys.r=d; }
        function updJump(){
            jmpCtx.fillStyle='#050511'; jmpCtx.fillRect(0,0,300,400);

            // Player physics
            if(jmpKeys.l) jmpP.x -= 6;
            if(jmpKeys.r) jmpP.x += 6;
            // Screen wrap
            if(jmpP.x < -20) jmpP.x = 300;
            if(jmpP.x > 300) jmpP.x = -20;

            jmpP.vy += 0.4; // Gravity
            jmpP.y += jmpP.vy;

            // Camera follow (Move platforms down if player goes high)
            if(jmpP.y < 150){
                let diff = 150 - jmpP.y;
                jmpP.y = 150;
                jmpH += diff;
                document.getElementById('jump-score').innerText=Math.floor(jmpH);
                jmpPlats.forEach(p => {
                    p.y += diff;
                    if(p.y > 400){
                        p.y = -10; p.x = Math.random()*240; // Recycle platform
                    }
                });
            }

            // Draw Platforms
            jmpCtx.fillStyle='#0aff68';
            jmpPlats.forEach(p=>{
                jmpCtx.fillRect(p.x, p.y, 60, 10);
                // Collision
                if(jmpP.vy>0 && jmpP.x+20 > p.x && jmpP.x < p.x+60 && jmpP.y+20 > p.y && jmpP.y+20 < p.y+20){
                    jmpP.vy = -9; // Jump!
                }
            });

            // Draw Player
            jmpCtx.fillStyle='#bc13fe';
            jmpCtx.beginPath(); jmpCtx.arc(jmpP.x+10, jmpP.y+10, 10, 0, 6.28); jmpCtx.fill();
            // Eyes
            jmpCtx.fillStyle='#fff'; 
            jmpCtx.fillRect(jmpP.x+4, jmpP.y+6, 4, 4); jmpCtx.fillRect(jmpP.x+12, jmpP.y+6, 4, 4);

            // Game Over
            if(jmpP.y > 400){
                intervals.forEach(clearInterval); alert("Fall! Height: "+Math.floor(jmpH));
            }
        }

        // --- GAME 26: Space Shooter (Logic) ---
        const spCtx = document.getElementById('space-canvas').getContext('2d');
        let spP={x:135,y:360}, spBuls=[], spEnems=[], spScore=0, spKeys={l:false,r:false}, spTick=0, spLevel=1;
        function startSpace(){
            spP={x:135,y:360}; spBuls=[]; spEnems=[]; spScore=0; spKeys={l:false,r:false}; spTick=0; spLevel=1;
            document.getElementById('space-score').innerText=0;
            document.getElementById('space-level').innerText=1;
            intervals.forEach(clearInterval); intervals.push(setInterval(updSpace, 20));
        }
        function spaceMove(k, d){ if(k=='ArrowLeft'||k=='a') spKeys.l=d; if(k=='ArrowRight'||k=='d') spKeys.r=d; }
        function spaceKey(k){ if(k==' '||k=='Enter'||k=='a'||k=='A') spBuls.push({x:spP.x+15, y:spP.y}); }
        function updSpace(){
            spCtx.fillStyle='#050511'; spCtx.fillRect(0,0,300,400);
            spCtx.fillStyle='#fff'; if(Math.random()<0.1) spCtx.fillRect(Math.random()*300, Math.random()*400, 1, 1);
            if(spKeys.l && spP.x>0) spP.x-=5; if(spKeys.r && spP.x<270) spP.x+=5;
            spCtx.fillStyle='#00f3ff'; spCtx.beginPath(); 
            spCtx.moveTo(spP.x+15,spP.y); spCtx.lineTo(spP.x,spP.y+30); spCtx.lineTo(spP.x+15,spP.y+20); spCtx.lineTo(spP.x+30,spP.y+30); spCtx.fill();
            spCtx.fillStyle='#ff0'; spBuls.forEach((b,i)=>{ b.y-=10; spCtx.fillRect(b.x-2,b.y,4,12); if(b.y<0)spBuls.splice(i,1); });
            spLevel = 1 + Math.floor(spScore/500); document.getElementById('space-level').innerText = spLevel;
            let spawnRate = Math.max(10, 50 - spLevel*2); let enemySpeed = 2 + spLevel*0.5;
            spTick++; if(spTick % spawnRate == 0) spEnems.push({x:Math.random()*270, y:-30, rot:0, type:Math.floor(Math.random()*3)});
            spEnems.forEach((e,i)=>{
                e.y += enemySpeed; e.rot += 0.1;
                spCtx.save(); spCtx.translate(e.x+15, e.y+15); spCtx.rotate(e.rot);
                if(e.type==0){ spCtx.fillStyle='#ff0055'; spCtx.fillRect(-15,-15,30,30); } else if (e.type==1){ spCtx.fillStyle='#bc13fe'; spCtx.beginPath(); spCtx.moveTo(0,-15); spCtx.lineTo(15,15); spCtx.lineTo(-15,15); spCtx.fill(); } else { spCtx.fillStyle='#0aff68'; spCtx.beginPath(); for(let k=0;k<6;k++) spCtx.lineTo(15*Math.cos(k*Math.PI/3), 15*Math.sin(k*Math.PI/3)); spCtx.fill(); }
                spCtx.restore();
                if(e.y>400){ intervals.forEach(clearInterval); alert("Game Over! Score: "+spScore); }
                spBuls.forEach((b,bi)=>{ if(b.x>e.x && b.x<e.x+30 && b.y>e.y && b.y<e.y+30){ spEnems.splice(i,1); spBuls.splice(bi,1); spScore+=50; document.getElementById('space-score').innerText=spScore; }});
            });
        }

        // --- GAME 27: Stacker (Logic) ---
        const stkCtx = document.getElementById('stack-canvas').getContext('2d');
        let stkH=15, stkW=10, stkRow=0, stkPos=0, stkDir=1, stkLen=4, stkG=[], stkState='play', stkSpeed=350;
        function startStack(){
            stkG=Array(stkH).fill(0).map(()=>({x:0,w:0})); stkRow=0; stkPos=0; stkDir=1; stkLen=4; stkState='play'; stkSpeed=350;
            document.getElementById('stack-score').innerText=0;
            intervals.forEach(clearInterval); intervals.push(setInterval(updStack, stkSpeed));
        }
        function updStack(){
            if(stkState!='play') return;
            stkPos += stkDir; if(stkPos<0 || stkPos+stkLen>stkW){ stkDir *= -1; stkPos += stkDir; }
            drawStack();
        }
        function drawStack(){
            stkCtx.fillStyle='#111'; stkCtx.fillRect(0,0,240,360);
            let unit=240/stkW; let hUnit=360/stkH;
            stkCtx.fillStyle='#0aff68'; stkCtx.fillRect(stkPos*unit, 360-(stkRow+1)*hUnit, stkLen*unit, hUnit-2);
            stkG.forEach((r,i)=>{ if(r.w>0) { stkCtx.fillStyle=`hsl(${i*25}, 100%, 50%)`; stkCtx.fillRect(r.x*unit, 360-(i+1)*hUnit, r.w*unit, hUnit-2); }});
        }
        function stackPlace(){
            if(stkState!='play') return;
            if(stkRow===0){ stkG[0]={x:stkPos, w:stkLen}; } else {
                let prev = stkG[stkRow-1]; let start = Math.max(prev.x, stkPos); let end = Math.min(prev.x+prev.w, stkPos+stkLen); let newW = end - start;
                if(newW <= 0){ stkState='over'; alert("Game Over! Score: "+stkRow); return; }
                stkLen = newW; stkG[stkRow] = {x:start, w:stkLen};
            }
            stkRow++; document.getElementById('stack-score').innerText=stkRow;
            if(stkRow>=stkH){ stkState='win'; alert("You Win! Amazing!"); return; }
            stkPos=0; stkDir=1; clearInterval(intervals[0]); stkSpeed = Math.max(50, 350 - stkRow * 20); intervals.push(setInterval(updStack, stkSpeed)); drawStack();
        }

        // --- GAME 29: Maze (Logic) ---
        const mzCtx = document.getElementById('maze-canvas').getContext('2d');
        let mzGrid=[], mzRows=15, mzCols=15, mzP={c:0,r:0}, mzEnd={c:14,r:14}, mzTime=0;
        function startMaze(){
            mzRows=15; mzCols=15; mzGrid = [];
            for(let r=0; r<mzRows; r++){ let row = []; for(let c=0; c<mzCols; c++) row.push({top:1, right:1, bot:1, left:1, vis:false}); mzGrid.push(row); }
            let stack = [{r:0,c:0}]; mzGrid[0][0].vis = true;
            while(stack.length > 0){
                let curr = stack[stack.length-1]; let neighbors = [];
                if(curr.r>0 && !mzGrid[curr.r-1][curr.c].vis) neighbors.push({r:curr.r-1, c:curr.c, dir:'top', opp:'bot'});
                if(curr.c<mzCols-1 && !mzGrid[curr.r][curr.c+1].vis) neighbors.push({r:curr.r, c:curr.c+1, dir:'right', opp:'left'});
                if(curr.r<mzRows-1 && !mzGrid[curr.r+1][curr.c].vis) neighbors.push({r:curr.r+1, c:curr.c, dir:'bot', opp:'top'});
                if(curr.c>0 && !mzGrid[curr.r][curr.c-1].vis) neighbors.push({r:curr.r, c:curr.c-1, dir:'left', opp:'right'});
                if(neighbors.length > 0){ let next = neighbors[Math.floor(Math.random()*neighbors.length)]; mzGrid[curr.r][curr.c][next.dir] = 0; mzGrid[next.r][next.c][next.opp] = 0; mzGrid[next.r][next.c].vis = true; stack.push(next); } else { stack.pop(); }
            }
            mzP = {c:0, r:0}; mzEnd = {c:mzCols-1, r:mzRows-1}; mzTime=0;
            intervals.forEach(clearInterval); intervals.push(setInterval(()=>{mzTime++; document.getElementById('maze-time').innerText=mzTime;},1000)); drawMaze();
        }
        function drawMaze(){
            let cs = 300/mzCols; mzCtx.fillStyle='#000'; mzCtx.fillRect(0,0,300,300); mzCtx.strokeStyle='#00f3ff'; mzCtx.lineWidth=2;
            for(let r=0; r<mzRows; r++){ for(let c=0; c<mzCols; c++){ let cell = mzGrid[r][c]; let x = c*cs, y = r*cs; mzCtx.beginPath(); if(cell.top) { mzCtx.moveTo(x,y); mzCtx.lineTo(x+cs,y); } if(cell.right) { mzCtx.moveTo(x+cs,y); mzCtx.lineTo(x+cs,y+cs); } if(cell.bot) { mzCtx.moveTo(x,y+cs); mzCtx.lineTo(x+cs,y+cs); } if(cell.left) { mzCtx.moveTo(x,y); mzCtx.lineTo(x,y+cs); } mzCtx.stroke(); }}
            mzCtx.fillStyle='#0aff68'; mzCtx.beginPath(); mzCtx.arc(mzP.c*cs+cs/2, mzP.r*cs+cs/2, cs/3, 0, 6.28); mzCtx.fill();
            mzCtx.fillStyle='#ff0055'; mzCtx.fillRect(mzEnd.c*cs+5, mzEnd.r*cs+5, cs-10, cs-10);
        }
        function mazeKey(k){
            let cell = mzGrid[mzP.r][mzP.c];
            if(k=='ArrowUp' && !cell.top) mzP.r--; if(k=='ArrowDown' && !cell.bot) mzP.r++; if(k=='ArrowLeft' && !cell.left) mzP.c--; if(k=='ArrowRight' && !cell.right) mzP.c++;
            drawMaze(); if(mzP.c==mzEnd.c && mzP.r==mzEnd.r){ intervals.forEach(clearInterval); alert("Maze Escaped! Time: "+mzTime+"s"); }
        }

        // --- Other Logic (Snake, etc.) to keep file working ---
        // Snake
        let snk=[],sfd={},sd,ssc=0; const sctx=document.getElementById('snake-canvas').getContext('2d'); 
        function startSnake(){ snk=[{x:150,y:150}]; sfd={x:100,y:100}; sd="RIGHT"; ssc=0; document.getElementById('snake-score').innerText=0; intervals.forEach(clearInterval); intervals.push(setInterval(drawSnake, 100)); } 
        function snakeKey(k){if((k=='ArrowLeft')&&sd!='RIGHT')sd='LEFT';if((k=='ArrowUp')&&sd!='DOWN')sd='UP';if((k=='ArrowRight')&&sd!='LEFT')sd='RIGHT';if((k=='ArrowDown')&&sd!='UP')sd='DOWN';} 
        function drawSnake(){ sctx.fillStyle='#222';sctx.fillRect(0,0,300,300);for(let i=0;i<snk.length;i++){sctx.fillStyle='#0f0';sctx.fillRect(snk[i].x,snk[i].y,15,15);}sctx.fillStyle='#f00';sctx.fillRect(sfd.x,sfd.y,15,15);let h={x:snk[0].x,y:snk[0].y};if(sd=='LEFT')h.x-=15;if(sd=='UP')h.y-=15;if(sd=='RIGHT')h.x+=15;if(sd=='DOWN')h.y+=15; if(h.x==sfd.x&&h.y==sfd.y){ssc++; document.getElementById('snake-score').innerText=ssc;sfd={x:Math.floor(Math.random()*19)*15,y:Math.floor(Math.random()*19)*15};}else snk.pop(); if(h.x<0||h.x>=300||h.y<0||h.y>=300||snk.some(s=>s.x==h.x&&s.y==h.y)){clearInterval(intervals[0]); alert("Game Over: "+ssc);}else snk.unshift(h); }
        function init2048(){} function handle2048(k){} function startTetris(){} function tetrisKey(k){} function startBird(){} function birdKey(k){}
    </script>
</body>
</html>
