<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WAYNAçš„éŠæˆ²å¤©å ‚ - ä¸Šç­æ—ç‰ˆ</title>
    <style>
        :root {
            --primary: #00ADB5;
            --secondary: #FF2E63;
            --dark: #222831;
            --grey: #393E46;
            --light: #EEEEEE;
            --accent: #F9ED69;
        }
        body {
            font-family: 'å¾®è»Ÿæ­£é»‘é«”', sans-serif;
            background-color: var(--dark);
            color: var(--light);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        
        /* Sidebar Navigation */
        #sidebar {
            width: 260px;
            background-color: var(--grey);
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.5);
            z-index: 10;
            position: relative;
        }
        h1 { 
            font-size: 22px; 
            color: var(--primary); 
            text-align: center; 
            margin-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
        }
        /* Slack Timer */
        #slack-timer-box {
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--secondary);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            margin-bottom: 15px;
        }
        #slack-timer { font-size: 24px; font-weight: bold; color: var(--accent); font-family: monospace; }
        .timer-label { font-size: 12px; color: #aaa; }

        .nav-header { font-size: 12px; color: #aaa; margin-top: 15px; margin-bottom: 5px; text-transform: uppercase; border-bottom: 1px solid #555; padding-bottom: 2px;}
        .nav-btn {
            background: none;
            border: none;
            color: var(--light);
            padding: 10px 15px;
            margin-bottom: 2px;
            cursor: pointer;
            text-align: left;
            transition: 0.2s;
            border-radius: 8px;
            font-size: 14px;
            width: 100%;
        }
        .nav-btn:hover { background-color: rgba(255,255,255,0.1); }
        .nav-btn.active {
            background-color: var(--primary);
            color: var(--dark);
            font-weight: bold;
            box-shadow: 0 0 10px var(--primary);
        }

        /* Main Game Area */
        #game-area {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            background: radial-gradient(circle at center, #2d3436 0%, #222831 100%);
        }
        .game-section {
            display: none;
            background: rgba(0,0,0,0.4);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            text-align: center;
            width: 90%;
            max-width: 650px;
            border: 1px solid rgba(255,255,255,0.1);
            max-height: 95vh;
            overflow-y: auto;
        }
        .game-section.active { display: block; animation: fadeIn 0.4s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Controls */
        button.action-btn {
            background-color: var(--primary);
            color: var(--dark);
            border: none;
            padding: 8px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 50px;
            margin: 8px;
            font-weight: bold;
            transition: 0.2s;
            outline: none;
        }
        button.action-btn:hover { transform: scale(1.05); box-shadow: 0 0 15px var(--primary); }
        input { padding: 8px; font-size: 16px; width: 100px; text-align: center; border-radius: 5px; border: none; }
        .score-board { font-size: 18px; color: var(--secondary); font-weight: bold; margin: 10px 0; }
        canvas { background: #000; border: 2px solid var(--primary); margin: 0 auto; display: block; max-width: 100%; }

        /* --- Specific Game Styles --- */
        
        /* Tic Tac Toe */
        .board { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin: 15px auto; width: 200px; }
        .cell { width: 60px; height: 60px; background: var(--grey); display: flex; align-items: center; justify-content: center; font-size: 36px; cursor: pointer; border-radius: 8px; }
        .cell.taken { cursor: default; }

        /* Mole */
        .mole-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 220px; margin: 15px auto; }
        .mole-hole { width: 65px; height: 65px; background: #444; border-radius: 50%; position: relative; overflow: hidden; cursor: pointer; border: 3px solid #555; }
        .mole { width: 100%; height: 100%; background: var(--secondary); border-radius: 50%; position: absolute; top: 100%; transition: top 0.1s; }
        .mole-hole.active .mole { top: 0; }

        /* Memory */
        .memory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; width: 280px; margin: 15px auto; }
        .memory-card { width: 60px; height: 60px; background: var(--primary); border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 28px; color: transparent; transition: transform 0.3s; }
        .memory-card.flipped { background: #fff; color: #333; transform: rotateY(180deg); }
        .memory-card.matched { background: var(--secondary); color: #fff; visibility: hidden; }

        /* Minesweeper */
        #minesweeper-grid { display: grid; gap: 2px; margin: 15px auto; background: #555; padding: 2px; width: fit-content; }
        .mine-cell { width: 30px; height: 30px; background: #bbb; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; color: #000; font-size: 14px; }
        .mine-cell.revealed { background: #ddd; }
        .mine-cell.bomb { background: #e74c3c; }

        /* Slots */
        .slot-machine { display: flex; justify-content: center; gap: 10px; margin: 20px 0; background: #333; padding: 20px; border-radius: 10px; border: 4px solid var(--accent); }
        .slot-reel { width: 60px; height: 80px; background: #fff; border-radius: 5px; font-size: 40px; display: flex; align-items: center; justify-content: center; color: #333; }

        /* Simon */
        .simon-board { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 200px; margin: 20px auto; }
        .simon-btn { height: 90px; border-radius: 10px; opacity: 0.6; cursor: pointer; transition: 0.1s; border: 2px solid #fff; }
        .simon-btn:active, .simon-btn.lit { opacity: 1; transform: scale(0.95); box-shadow: 0 0 20px currentColor; }
        .sb-r { background: #ff5252; color: #ff5252; } .sb-g { background: #69f0ae; color: #69f0ae; }
        .sb-b { background: #448aff; color: #448aff; } .sb-y { background: #ffff00; color: #ffff00; }

        /* 15 Puzzle */
        .puzzle-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 4px; width: 240px; margin: 20px auto; background: #333; padding: 4px; }
        .puzzle-tile { width: 55px; height: 55px; background: var(--primary); display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; cursor: pointer; color: var(--dark); border-radius: 4px; }
        .puzzle-tile.empty { background: transparent; cursor: default; }

        .mobile-controls { margin-top: 10px; display: none; }
        @media (max-width: 768px) { .mobile-controls { display: block; } #sidebar { display: none; /* Mobile logic needed if full mobile support desired, but simplifying for now */ } }

    </style>
</head>
<body>

    <div id="sidebar">
        <h1>WAYNAçš„<br>éŠæˆ²å¤©å ‚</h1>

        <div id="slack-timer-box">
            <div class="timer-label">æœ¬æ—¥æ‘¸é­šæ™‚é–“</div>
            <div id="slack-timer">00:00:00</div>
        </div>
        
        <button class="nav-btn active" onclick="switchGame('welcome')">ğŸ  å¤§å»³é¦–é </button>

        <div class="nav-header">ç¶“å…¸ç³»åˆ—</div>
        <button class="nav-btn" onclick="switchGame('game1')">â­•âŒ äº•å­—éŠæˆ²</button>
        <button class="nav-btn" onclick="switchGame('game2')">ğŸ”¢ çµ‚æ¥µå¯†ç¢¼</button>
        <button class="nav-btn" onclick="switchGame('game3')">âœŒâœŠâœ‹ çŒœæ‹³</button>
        <button class="nav-btn" onclick="switchGame('game4')">âš¡ æ‰‹é€Ÿç‹</button>
        <button class="nav-btn" onclick="switchGame('game5')">ğŸ¨ åæ‡‰åŠ›</button>

        <div class="nav-header">æŠ€è¡“ç³»åˆ—</div>
        <button class="nav-btn" onclick="switchGame('game6')">ğŸ è²ªé£Ÿè›‡</button>
        <button class="nav-btn" onclick="switchGame('game7')">ğŸ¹ æ‰“åœ°é¼ </button>
        <button class="nav-btn" onclick="switchGame('game8')">ğŸ´ è¨˜æ†¶ç¿»ç‰Œ</button>
        <button class="nav-btn" onclick="switchGame('game9')">ğŸš€ é–ƒé¿çƒ</button>
        <button class="nav-btn" onclick="switchGame('game10')">â• æ•¸å­¸éš¨å ‚è€ƒ</button>

        <div class="nav-header">V5.0 æ–°å¢ (ä¸Šç­æ—ç‰ˆ)</div>
        <button class="nav-btn" onclick="switchGame('game11')">ğŸ§± æ‰“ç£šå¡Š</button>
        <button class="nav-btn" onclick="switchGame('game12')">ğŸ’£ è¸©åœ°é›·</button>
        <button class="nav-btn" onclick="switchGame('game13')">ğŸ° å¹¸é‹æ‹‰éœ¸</button>
        <button class="nav-btn" onclick="switchGame('game14')">ğŸ§  åºåˆ—è¨˜æ†¶</button>
        <button class="nav-btn" onclick="switchGame('game15')">ğŸ§© æ•¸å­—æ¨ç›¤</button>
    </div>

    <div id="game-area">
        
        <div id="welcome" class="game-section active">
            <h2 style="font-size: 32px; color: var(--primary);">WAYNAçš„éŠæˆ²å¤©å ‚</h2>
            <p>åŒ…å« 15 æ¬¾å°éŠæˆ²èˆ‡æ‘¸é­šè¨ˆæ™‚å™¨ã€‚</p>
            <p style="color: var(--accent);">æ­£åœ¨è¨ˆç®—ä½ çš„æ‘¸é­šæ™‚é–“...</p>
            <p style="font-size: 14px; color: #aaa;">æç¤ºï¼šè²ªé£Ÿè›‡ã€æ‰“ç£šå¡Šã€é–ƒé¿çƒè«‹ä½¿ç”¨éµç›¤æ“ä½œã€‚</p>
        </div>

        <div id="game1" class="game-section"><h2>äº•å­—éŠæˆ² (VS é›»è…¦)</h2><div class="score-board" id="ttt-status">è¼ªåˆ°ä½  (X)</div><div class="board" id="ttt-board"></div><button class="action-btn" onclick="resetTTT()">é‡ç½®</button></div>
        <div id="game2" class="game-section"><h2>çµ‚æ¥µå¯†ç¢¼ (1-100)</h2><input type="number" id="guess-input" placeholder="?" onkeypress="if(event.key==='Enter') checkGuess()"><button class="action-btn" onclick="checkGuess()">çŒœ</button><div class="score-board" id="guess-result">æº–å‚™é–‹å§‹</div><button class="action-btn" onclick="resetGuess()">é‡ä¾†</button></div>
        <div id="game3" class="game-section"><h2>å‰ªåˆ€çŸ³é ­å¸ƒ</h2><div class="score-board" id="rps-score">ä½  0 - 0 é›»è…¦</div><div style="margin:20px;"><button class="action-btn" onclick="playRPS('âœŠ')">âœŠ</button><button class="action-btn" onclick="playRPS('âœ‹')">âœ‹</button><button class="action-btn" onclick="playRPS('âœŒ')">âœŒ</button></div><div id="rps-result" style="font-size:20px;">å‡ºæ‹³å§</div></div>
        <div id="game4" class="game-section"><h2>5ç§’æ‰‹é€Ÿç‹</h2><div style="width:120px; height:120px; background:var(--secondary); border-radius:50%; margin:20px auto; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:20px; user-select:none;" onmousedown="clickCount()">é»æˆ‘</div><div class="score-board">æ™‚é–“: <span id="click-time">5.0</span> | æ¬¡æ•¸: <span id="click-score">0</span></div><button class="action-btn" onclick="startClicker()">é–‹å§‹</button></div>
        <div id="game5" class="game-section"><h2>æ¥µé™åæ‡‰åŠ›</h2><div id="reflex-box" style="width:100%; height:120px; background:#444; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:20px; cursor:pointer; user-select:none;" onmousedown="reflexClick()">é»æ“Šé–‹å§‹</div><div class="score-board" id="reflex-msg"></div><button class="action-btn" onclick="startReflex()">æ¸¬è©¦</button></div>
        
        <div id="game6" class="game-section">
            <h2>ç¶“å…¸è²ªé£Ÿè›‡</h2>
            <div class="score-board">åˆ†æ•¸: <span id="snake-score">0</span></div>
            <canvas id="snake-canvas" width="300" height="300"></canvas>
            <p style="font-size:12px; color:#aaa;">æŒ‰é–‹å§‹å¾Œç”¨éµç›¤ WSAD æˆ–æ–¹å‘éµæ§åˆ¶</p>
            <button class="action-btn" onclick="startSnake()">é–‹å§‹éŠæˆ²</button>
        </div>

        <div id="game7" class="game-section"><h2>æ‰“åœ°é¼ </h2><div class="score-board">åˆ†: <span id="mole-score">0</span> | ç§’: <span id="mole-time">30</span></div><div class="mole-grid" id="mole-grid"></div><button class="action-btn" onclick="startMole()">é–‹å§‹</button></div>
        <div id="game8" class="game-section"><h2>è¨˜æ†¶ç¿»ç‰Œ</h2><div class="memory-grid" id="memory-grid"></div><button class="action-btn" onclick="initMemory()">é‡æ´—</button></div>
        
        <div id="game9" class="game-section">
            <h2>å¤ªç©ºé–ƒé¿çƒ</h2>
            <p style="font-size:12px;">å·¦å³éµèº²é¿</p>
            <canvas id="dodge-canvas" width="300" height="300"></canvas>
            <div class="score-board">å­˜æ´»: <span id="dodge-score">0</span></div>
            <button class="action-btn" onclick="startDodge()">ç™¼å°„</button>
        </div>

        <div id="game10" class="game-section"><h2>æ•¸å­¸éš¨å ‚è€ƒ</h2><div class="score-board">ç­”å°: <span id="math-score">0</span></div><div id="math-question" style="font-size:32px; margin:15px;">?</div><input type="number" id="math-input" placeholder="ç­”æ¡ˆ" onkeypress="if(event.key==='Enter') checkMath()"><button class="action-btn" onclick="checkMath()">é€å‡º</button></div>

        <div id="game11" class="game-section">
            <h2>æ‰“ç£šå¡Š</h2>
            <div class="score-board">åˆ†æ•¸: <span id="break-score">0</span></div>
            <canvas id="break-canvas" width="300" height="300"></canvas>
            <p style="font-size:12px; color:#aaa;">å·¦å³éµç§»å‹•æ“‹æ¿</p>
            <button class="action-btn" onclick="startBreakout()">é–‹å§‹</button>
        </div>

        <div id="game12" class="game-section">
            <h2>è¸©åœ°é›· (8x8)</h2>
            <p style="font-size:12px;">å…±æœ‰ 8 é¡†åœ°é›·</p>
            <div id="minesweeper-grid"></div>
            <div class="score-board" id="mine-msg"></div>
            <button class="action-btn" onclick="initMinesweeper()">é‡ç½®</button>
        </div>

        <div id="game13" class="game-section">
            <h2>å¹¸é‹æ‹‰éœ¸æ©Ÿ</h2>
            <div class="slot-machine">
                <div class="slot-reel" id="reel1">7</div>
                <div class="slot-reel" id="reel2">7</div>
                <div class="slot-reel" id="reel3">7</div>
            </div>
            <div class="score-board" id="slot-msg">è©¦è©¦æ‰‹æ°£ï¼</div>
            <button class="action-btn" onclick="spinSlots()">æ‹‰éœ¸ï¼</button>
        </div>

        <div id="game14" class="game-section">
            <h2>åºåˆ—è¨˜æ†¶ (Simon)</h2>
            <div class="score-board">Level: <span id="simon-level">1</span></div>
            <div class="simon-board">
                <div class="simon-btn sb-r" id="sb-0" onclick="handleSimonInput(0)"></div>
                <div class="simon-btn sb-g" id="sb-1" onclick="handleSimonInput(1)"></div>
                <div class="simon-btn sb-b" id="sb-2" onclick="handleSimonInput(2)"></div>
                <div class="simon-btn sb-y" id="sb-3" onclick="handleSimonInput(3)"></div>
            </div>
            <div id="simon-msg" style="height:20px;">é»æ“Šé–‹å§‹</div>
            <button class="action-btn" onclick="startSimon()">é–‹å§‹</button>
        </div>

        <div id="game15" class="game-section">
            <h2>æ•¸å­—æ¨ç›¤</h2>
            <div class="puzzle-grid" id="puzzle-grid"></div>
            <div class="score-board" id="puzzle-msg">æ’åˆ— 1-15</div>
            <button class="action-btn" onclick="initPuzzle()">æ´—ç‰Œ</button>
        </div>

    </div>

    <script>
        // --- Slack Timer Logic ---
        let slackSeconds = 0;
        setInterval(() => {
            slackSeconds++;
            const h = Math.floor(slackSeconds / 3600).toString().padStart(2, '0');
            const m = Math.floor((slackSeconds % 3600) / 60).toString().padStart(2, '0');
            const s = (slackSeconds % 60).toString().padStart(2, '0');
            document.getElementById('slack-timer').innerText = `${h}:${m}:${s}`;
        }, 1000);

        // --- System Management ---
        let activeGame = 'welcome';
        let intervals = []; 
        function switchGame(id) {
            intervals.forEach(clearInterval);
            intervals = [];
            document.querySelectorAll('.game-section').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            // Find index simply by looping to avoid long array
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.getAttribute('onclick').includes(`'${id}'`)) btn.classList.add('active');
            });
            activeGame = id;
            if(document.activeElement) document.activeElement.blur();

            // Init specific games
            if(id === 'game7') createMoleGrid();
            if(id === 'game8') initMemory();
            if(id === 'game10') initMath();
            if(id === 'game12') initMinesweeper();
            if(id === 'game15') initPuzzle();
        }

        // --- GLOBAL KEY HANDLER ---
        window.addEventListener('keydown', function(e) {
            const key = e.key;
            // Prevent scrolling
            if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," "].includes(key)) {
                if(['game6','game9','game11'].includes(activeGame)) e.preventDefault();
            }
            // Snake
            if(activeGame === 'game6') {
                if(key==='ArrowLeft'||key==='a'||key==='A') changeSnakeDir('LEFT');
                if(key==='ArrowUp'||key==='w'||key==='W') changeSnakeDir('UP');
                if(key==='ArrowRight'||key==='d'||key==='D') changeSnakeDir('RIGHT');
                if(key==='ArrowDown'||key==='s'||key==='S') changeSnakeDir('DOWN');
            }
            // Dodge
            if(activeGame === 'game9') {
                if(key==='ArrowLeft'||key==='a'||key==='A') dodgeMove(-1);
                if(key==='ArrowRight'||key==='d'||key==='D') dodgeMove(1);
            }
            // Breakout
            if(activeGame === 'game11') {
                if(key==='ArrowLeft'||key==='a'||key==='A') breakPaddleMove = -5;
                if(key==='ArrowRight'||key==='d'||key==='D') breakPaddleMove = 5;
            }
        });
        window.addEventListener('keyup', function(e) {
            if(activeGame === 'game9') {
                if(['ArrowLeft','ArrowRight','a','d','A','D'].includes(e.key)) dodgeStop();
            }
            if(activeGame === 'game11') {
                if(['ArrowLeft','ArrowRight','a','d','A','D'].includes(e.key)) breakPaddleMove = 0;
            }
        });

        // --- 1. Tic Tac Toe ---
        let tttBoard=Array(9).fill(null);
        function resetTTT(){ tttBoard=Array(9).fill(null); renderTTT(); document.getElementById('ttt-status').innerText="è¼ªåˆ°ä½  (X)"; }
        function renderTTT(){ 
            const b=document.getElementById('ttt-board'); b.innerHTML=''; 
            tttBoard.forEach((v,i)=>{
                let c=document.createElement('div'); c.className=`cell ${v?'taken':''}`; c.innerText=v||'';
                c.onclick=()=>playTTT(i); b.appendChild(c);
            });
        }
        function playTTT(i){ if(tttBoard[i]||checkTTT(tttBoard))return; tttBoard[i]='X'; renderTTT(); if(!checkTTT(tttBoard)) setTimeout(cpuTTT,300); else endTTT(); }
        function cpuTTT(){
            let avail=tttBoard.map((v,i)=>v===null?i:null).filter(v=>v!==null);
            if(avail.length>0) tttBoard[avail[Math.floor(Math.random()*avail.length)]]='O';
            renderTTT(); endTTT();
        }
        function checkTTT(b){ const w=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]]; for(let l of w)if(b[l[0]]&&b[l[0]]===b[l[1]]&&b[l[0]]===b[l[2]])return b[l[0]]; return null;}
        function endTTT(){ let w=checkTTT(tttBoard); let s=document.getElementById('ttt-status'); if(w) s.innerText=w==='X'?"è´äº†!":"è¼¸äº†..."; else if(!tttBoard.includes(null)) s.innerText="å¹³æ‰‹";}
        
        // --- 2. Guess Number ---
        let gT=Math.floor(Math.random()*100)+1;
        function checkGuess(){ let v=parseInt(document.getElementById('guess-input').value); let m=document.getElementById('guess-result');
            if(v===gT){ m.innerText="ğŸ‰ çŒœå°äº†!"; m.style.color="#00ADB5"; } else m.innerText=v>gT?"å¤ªå¤§äº†":"å¤ªå°äº†";
            document.getElementById('guess-input').value=''; document.getElementById('guess-input').focus();
        }
        function resetGuess(){ gT=Math.floor(Math.random()*100)+1; document.getElementById('guess-result').innerText="æ–°å±€å·²é–‹"; }

        // --- 3. RPS ---
        function playRPS(u){ const c=['âœŠ','âœ‹','âœŒ'][Math.floor(Math.random()*3)];
            let r="å¹³æ‰‹"; if((u=='âœŠ'&&c=='âœŒ')||(u=='âœ‹'&&c=='âœŠ')||(u=='âœŒ'&&c=='âœ‹')) r="ä½ è´äº†"; else if(u!==c) r="é›»è…¦è´";
            document.getElementById('rps-result').innerText=`ä½ ${u} vs ${c}é›»è…¦ -> ${r}`;
        }

        // --- 4. Clicker ---
        let clkS=0, clkA=false;
        function startClicker(){ if(clkA)return; clkS=0; clkA=true; let t=5.0; document.getElementById('click-score').innerText=0;
            let tm=setInterval(()=>{ t-=0.1; document.getElementById('click-time').innerText=t.toFixed(1);
            if(t<=0){ clearInterval(tm); clkA=false; document.getElementById('click-time').innerText="0.0"; alert(`æ™‚é–“åˆ°! æˆç¸¾: ${clkS}`); } },100); intervals.push(tm);
        }
        function clickCount(){ if(clkA) document.getElementById('click-score').innerText=++clkS; }

        // --- 5. Reflex ---
        let refT;
        function startReflex(){
            let b=document.getElementById('reflex-box'); b.style.background="#444"; b.innerText="ç­‰å¾…è®Šç¶ ..."; b.onmousedown=null;
            refT=setTimeout(()=>{
                b.style.background="#00ADB5"; b.innerText="é»æ“Š!"; let s=Date.now();
                b.onmousedown=()=>{ document.getElementById('reflex-msg').innerText=`${Date.now()-s} ms`; b.onmousedown=null; }
            }, 1000+Math.random()*2000);
            intervals.push(setInterval(()=>{},1000)); // dummy for clear
        }
        function reflexClick(){ if(document.getElementById('reflex-box').style.background!=='rgb(0, 173, 181)') { clearTimeout(refT); document.getElementById('reflex-msg').innerText="å¤ªæ—©äº†!"; } }

        // --- 6. Snake ---
        const sc=document.getElementById('snake-canvas'), sctx=sc.getContext('2d');
        let snk=[], sfd={}, sd, ssc=0;
        function startSnake(){
            if(document.activeElement) document.activeElement.blur();
            snk=[{x:9*15,y:10*15}]; sfd={x:Math.floor(Math.random()*19)*15,y:Math.floor(Math.random()*19)*15}; sd="RIGHT"; ssc=0; document.getElementById('snake-score').innerText=0;
            intervals.forEach(clearInterval); intervals=[];
            intervals.push(setInterval(drawSnake,130));
        }
        function changeSnakeDir(dir){ 
            if(dir=='LEFT'&&sd!='RIGHT')sd='LEFT'; else if(dir=='UP'&&sd!='DOWN')sd='UP';
            else if(dir=='RIGHT'&&sd!='LEFT')sd='RIGHT'; else if(dir=='DOWN'&&sd!='UP')sd='DOWN';
        }
        function drawSnake(){
            sctx.fillStyle='#222831'; sctx.fillRect(0,0,300,300);
            for(let i=0;i<snk.length;i++){ sctx.fillStyle=i==0?'#00ADB5':'#EEE'; sctx.fillRect(snk[i].x,snk[i].y,15,15); }
            sctx.fillStyle='#FF2E63'; sctx.fillRect(sfd.x,sfd.y,15,15);
            let h={x:snk[0].x, y:snk[0].y};
            if(sd=='LEFT')h.x-=15; if(sd=='UP')h.y-=15; if(sd=='RIGHT')h.x+=15; if(sd=='DOWN')h.y+=15;
            if(h.x==sfd.x && h.y==sfd.y){ ssc++; document.getElementById('snake-score').innerText=ssc; sfd={x:Math.floor(Math.random()*19)*15,y:Math.floor(Math.random()*19)*15}; } else snk.pop();
            if(h.x<0||h.x>=300||h.y<0||h.y>=300||snk.some(s=>s.x==h.x&&s.y==h.y)){ clearInterval(intervals[0]); alert("Game Over: "+ssc); return;}
            snk.unshift(h);
        }

        // --- 7. Mole ---
        let msc=0, mt=30;
        function createMoleGrid(){ const g=document.getElementById('mole-grid'); g.innerHTML=''; for(let i=0;i<9;i++){let d=document.createElement('div');d.className='mole-hole';d.id=`mh-${i}`;d.innerHTML='<div class="mole"></div>';d.onclick=()=>bonk(i);g.appendChild(d);}}
        function startMole(){ msc=0; mt=30; document.getElementById('mole-score').innerText=0; document.getElementById('mole-time').innerText=30; peep(); intervals.push(setInterval(()=>{mt--;document.getElementById('mole-time').innerText=mt;if(mt<=0){clearInterval(intervals[0]);alert("æ™‚é–“åˆ°: "+msc);}},1000)); }
        function peep(){ if(mt<=0)return; let h=document.getElementById(`mh-${Math.floor(Math.random()*9)}`); h.classList.add('active'); setTimeout(()=>{h.classList.remove('active');if(mt>0)setTimeout(peep,300+Math.random()*500);},500+Math.random()*500); }
        function bonk(i){ let h=document.getElementById(`mh-${i}`); if(h.classList.contains('active')){ msc++; document.getElementById('mole-score').innerText=msc; h.classList.remove('active'); }}

        // --- 8. Memory ---
        let mc=[], hasF=false, lk=false, fc, scrd;
        function initMemory(){ const g=document.getElementById('memory-grid'); g.innerHTML=''; mc=['ğŸ','ğŸ','ğŸŒ','ğŸŒ','ğŸ‡','ğŸ‡','ğŸ‰','ğŸ‰','ğŸ¶','ğŸ¶','ğŸ±','ğŸ±','ğŸ¦Š','ğŸ¦Š','ğŸ¸','ğŸ¸'].sort(()=>0.5-Math.random()); 
            mc.forEach(i=>{let c=document.createElement('div');c.className='memory-card';c.dataset.f=i;c.innerText=i;c.onclick=flipC;g.appendChild(c);}); hasF=false; lk=false;}
        function flipC(){ if(lk||this===fc)return; this.classList.add('flipped'); if(!hasF){hasF=true;fc=this;return;} scrd=this; lk=true; 
            if(fc.dataset.f===scrd.dataset.f){fc.classList.add('matched');scrd.classList.add('matched');resetB();}else{setTimeout(()=>{fc.classList.remove('flipped');scrd.classList.remove('flipped');resetB();},1000);}}
        function resetB(){[hasF,lk]=[false,false];[fc,scrd]=[null,null];}

        // --- 9. Dodge ---
        const dcv=document.getElementById('dodge-canvas'), dct=dcv.getContext('2d');
        let dpx=135, dms=[], dsc=0, dmv=0;
        function startDodge(){ if(document.activeElement)document.activeElement.blur(); dpx=135; dms=[]; dsc=0; dmv=0; document.getElementById('dodge-score').innerText="0"; intervals.forEach(clearInterval); intervals=[]; 
            intervals.push(setInterval(()=>{
                dct.fillStyle='#222831'; dct.fillRect(0,0,300,300);
                dpx+=dmv; if(dpx<0)dpx=0; if(dpx>280)dpx=280;
                dct.fillStyle='#00ADB5'; dct.beginPath(); dct.moveTo(dpx+10,270); dct.lineTo(dpx,290); dct.lineTo(dpx+20,290); dct.fill();
                dct.fillStyle='#FF2E63'; dms.forEach(m=>{m.y+=m.s; dct.beginPath(); dct.arc(m.x,m.y,8,0,6.28); dct.fill();});
                if(dms.some(m=>m.x>dpx-5&&m.x<dpx+25&&m.y>270&&m.y<290)){ clearInterval(intervals[0]); clearInterval(intervals[1]); alert("Game Over: "+(dsc/10)); }
            },20));
            intervals.push(setInterval(()=>{ dms.push({x:Math.random()*280,y:-20,s:2+Math.random()*3}); dsc++; document.getElementById('dodge-score').innerText=(dsc/10).toFixed(1); },500));
        }
        function dodgeMove(d){ dmv=d*4; } function dodgeStop(){ dmv=0; }

        // --- 10. Math ---
        let mA, mB;
        function initMath(){ mA=Math.floor(Math.random()*20)+1; mB=Math.floor(Math.random()*20)+1; document.getElementById('math-question').innerText=`${mA} + ${mB} = ?`; }
        function checkMath(){ let v=parseInt(document.getElementById('math-input').value); let s=document.getElementById('math-score'); 
            if(v===mA+mB){ s.innerText=parseInt(s.innerText)+1; document.getElementById('math-input').value=''; initMath(); } 
            else { alert("éŒ¯äº†! æ­¸é›¶"); s.innerText=0; document.getElementById('math-input').value=''; }
        }

        // --- 11. Breakout (NEW) ---
        const bcv=document.getElementById('break-canvas'), bctx=bcv.getContext('2d');
        let bPadX=110, bBall={x:150,y:250,dx:2,dy:-2}, bBricks=[], bScore=0, breakPaddleMove=0;
        function startBreakout(){
            if(document.activeElement)document.activeElement.blur();
            bPadX=110; bBall={x:150,y:250,dx:3,dy:-3}; bScore=0; bBricks=[]; breakPaddleMove=0;
            document.getElementById('break-score').innerText=0;
            for(let c=0;c<5;c++) for(let r=0;r<4;r++) bBricks.push({x:c*(50+10)+5, y:r*(20+10)+30, status:1});
            intervals.forEach(clearInterval); intervals=[];
            intervals.push(setInterval(drawBreakout, 20));
        }
        function drawBreakout(){
            bctx.fillStyle='#222831'; bctx.fillRect(0,0,300,300);
            // Paddle
            bPadX += breakPaddleMove;
            if(bPadX<0) bPadX=0; if(bPadX>220) bPadX=220; // Paddle width 80
            bctx.fillStyle='#00ADB5'; bctx.fillRect(bPadX, 280, 80, 10);
            // Bricks
            bBricks.forEach(b=>{ if(b.status){
                bctx.fillStyle='#FF2E63'; bctx.fillRect(b.x, b.y, 50, 20);
                if(bBall.x>b.x && bBall.x<b.x+50 && bBall.y>b.y && bBall.y<b.y+20){ bBall.dy=-bBall.dy; b.status=0; bScore++; document.getElementById('break-score').innerText=bScore;}
            }});
            if(bScore===20){ clearInterval(intervals[0]); alert("æ­å–œé€šé—œ!"); return; }
            // Ball
            bBall.x += bBall.dx; bBall.y += bBall.dy;
            if(bBall.x<0 || bBall.x>300) bBall.dx=-bBall.dx;
            if(bBall.y<0) bBall.dy=-bBall.dy;
            if(bBall.y>300) { clearInterval(intervals[0]); alert("Game Over"); return; }
            // Paddle Hit
            if(bBall.y>270 && bBall.y<280 && bBall.x>bPadX && bBall.x<bPadX+80) bBall.dy=-Math.abs(bBall.dy); // Force up
            bctx.beginPath(); bctx.arc(bBall.x, bBall.y, 5, 0, Math.PI*2); bctx.fillStyle='#fff'; bctx.fill();
        }

        // --- 12. Minesweeper (NEW) ---
        let msGrid=[], msMines=[], msRevealed=0, msGameOver=false;
        function initMinesweeper(){
            const g=document.getElementById('minesweeper-grid'); g.innerHTML=''; msGrid=[]; msMines=[]; msRevealed=0; msGameOver=false;
            g.style.gridTemplateColumns='repeat(8, 1fr)';
            document.getElementById('mine-msg').innerText='';
            // 8x8 Grid, 8 Mines
            let idxs=Array(64).fill(0).map((_,i)=>i).sort(()=>Math.random()-0.5);
            let bombs=idxs.slice(0,8);
            for(let i=0;i<64;i++){
                let d=document.createElement('div'); d.className='mine-cell'; d.dataset.id=i;
                d.onclick=()=>clickMine(i);
                if(bombs.includes(i)) msMines.push(i);
                g.appendChild(d);
            }
        }
        function clickMine(i){
            if(msGameOver) return;
            let cells=document.querySelectorAll('.mine-cell');
            if(msMines.includes(i)){
                cells[i].classList.add('bomb'); cells[i].innerText='ğŸ’£';
                document.getElementById('mine-msg').innerText="ğŸ’¥ çˆ†ç‚¸äº†!";
                msMines.forEach(m=>{cells[m].classList.add('bomb'); cells[m].innerText='ğŸ’£';});
                msGameOver=true;
            } else {
                let bombCount=0;
                let adj=[-9,-8,-7,-1,1,7,8,9];
                adj.forEach(a=>{ let n=i+a; if(n>=0 && n<64 && Math.abs((n%8)-(i%8))<=1 && msMines.includes(n)) bombCount++; });
                cells[i].classList.add('revealed'); cells[i].innerText=bombCount>0?bombCount:'';
                cells[i].onclick=null; // disable click
                msRevealed++;
                if(msRevealed === 64-8) { document.getElementById('mine-msg').innerText="ğŸ‰ æƒé›·æˆåŠŸ!"; msGameOver=true; }
                // Simple flood fill for 0s could be added here, but keeping simple
            }
        }

        // --- 13. Slots (NEW) ---
        function spinSlots(){
            let msg=document.getElementById('slot-msg'); msg.innerText="è½‰å‹•ä¸­...";
            let reels=[document.getElementById('reel1'), document.getElementById('reel2'), document.getElementById('reel3')];
            let res=[];
            reels.forEach((r,i)=>{
                let count=0;
                let inv=setInterval(()=>{
                    r.innerText=Math.floor(Math.random()*9)+1;
                    count++;
                    if(count>10+i*5){
                        clearInterval(inv);
                        let final=Math.floor(Math.random()*9)+1; // Simple random, not rigged
                        r.innerText=final;
                        res.push(final);
                        if(res.length===3) checkSlots(res);
                    }
                }, 50);
            });
        }
        function checkSlots(res){
            let msg=document.getElementById('slot-msg');
            if(res[0]==res[1] && res[1]==res[2]){
                if(res[0]==7) msg.innerText="ğŸ° 777 å¤§ç!!! ğŸ°";
                else msg.innerText="ğŸ‰ ä¸­çäº†!";
            } else msg.innerText="å†è©¦ä¸€æ¬¡å§";
        }

        // --- 14. Simon (NEW) ---
        let simonSeq=[], simonUser=[], simonLvl=1, simonTurn=false;
        function startSimon(){ simonSeq=[]; simonLvl=1; nextSimonLevel(); }
        function nextSimonLevel(){
            simonUser=[]; simonTurn=false; document.getElementById('simon-level').innerText=simonLvl;
            document.getElementById('simon-msg').innerText="ä»”ç´°çœ‹...";
            simonSeq.push(Math.floor(Math.random()*4));
            let i=0;
            let inv=setInterval(()=>{
                flashSimon(simonSeq[i]); i++;
                if(i>=simonSeq.length){ clearInterval(inv); simonTurn=true; document.getElementById('simon-msg').innerText="è¼ªåˆ°ä½ äº†"; }
            }, 600);
        }
        function flashSimon(idx){
            let btn=document.getElementById(`sb-${idx}`); btn.classList.add('lit');
            setTimeout(()=>btn.classList.remove('lit'), 300);
        }
        function handleSimonInput(idx){
            if(!simonTurn) return;
            flashSimon(idx);
            simonUser.push(idx);
            if(simonUser[simonUser.length-1] !== simonSeq[simonUser.length-1]){
                document.getElementById('simon-msg').innerText="âŒ éŒ¯èª¤! éŠæˆ²çµæŸ"; simonTurn=false;
                return;
            }
            if(simonUser.length === simonSeq.length){
                simonTurn=false; simonLvl++;
                document.getElementById('simon-msg').innerText="âœ… æ­£ç¢º!";
                setTimeout(nextSimonLevel, 1000);
            }
        }

        // --- 15. 15 Puzzle (NEW) ---
        let pTiles=[];
        function initPuzzle(){
            pTiles=Array(16).fill(0).map((_,i)=>i); // 0-15, 15 is empty
            // Shuffle solvable
            for(let i=0;i<100;i++){
                let empty=pTiles.indexOf(15);
                let neighbors=[];
                if(empty%4>0) neighbors.push(empty-1); if(empty%4<3) neighbors.push(empty+1);
                if(empty>=4) neighbors.push(empty-4); if(empty<12) neighbors.push(empty+4);
                let swp=neighbors[Math.floor(Math.random()*neighbors.length)];
                [pTiles[empty], pTiles[swp]] = [pTiles[swp], pTiles[empty]];
            }
            renderPuzzle();
        }
        function renderPuzzle(){
            const g=document.getElementById('puzzle-grid'); g.innerHTML='';
            pTiles.forEach((v,i)=>{
                let d=document.createElement('div'); d.className=`puzzle-tile ${v===15?'empty':''}`;
                d.innerText=v===15?'':v+1;
                d.onclick=()=>moveTile(i);
                g.appendChild(d);
            });
            checkPuzzleWin();
        }
        function moveTile(i){
            let empty=pTiles.indexOf(15);
            if(Math.abs(i-empty)===1 && Math.floor(i/4)===Math.floor(empty/4) || Math.abs(i-empty)===4){
                [pTiles[i], pTiles[empty]] = [pTiles[empty], pTiles[i]];
                renderPuzzle();
            }
        }
        function checkPuzzleWin(){
            // Check if 0..14 are in order
            let win=true; for(let i=0;i<15;i++) if(pTiles[i]!==i) win=false;
            if(win) document.getElementById('puzzle-msg').innerText="ğŸ‰ å®Œæˆäº†!";
            else document.getElementById('puzzle-msg').innerText="æ’åˆ— 1-15";
        }

    </script>
</body>
</html>
